

fn printf(str format, ...) -> i32;
fn malloc(i64 size) -> i8*;
fn free(i8* ptr);

struct node {
    i32 value,
    node* next,
}

fn new_node(i32 value) -> node* {
    let node* ptr = malloc(sizeof(node)) as node*;
    *ptr.value = value;
    return ptr;
}

fn push_front(node* head, i32 value) -> node* {
    let node* ptr = new_node(value);
    *ptr.next = head;
    return ptr;
}

fn node_test() {
    let node* head = new_node(1);

    let i32 a = 2;
    let i32 b = 3;

    head = push_front(head, a);
    head = push_front(head, b);

    printf("head: %d\n", *head.value);
    printf("head.next: %d\n", *(*head.next).value);
    printf("head.next.next: %d\n", *(*(*head.next).next).value);

    free((*(*head).next).next as i8*);
    free((*head).next as i8*);
    free(head as i8*);
    return;
}

fn main() -> i32 {
    node_test();
    
    return 0;
}

